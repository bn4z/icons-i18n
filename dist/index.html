<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>icons-i18n test page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body{
            background-color: #444;
            padding: 2em;
            color: #fff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            text-align: center;
        }
        input{
            font-size: 2em;
            background-color: transparent;
            border: none;
            border-bottom: 3px solid orangered;
            text-align: center;
            color: orange;
            transition: border .2s;
            margin-bottom: 2em;
        }
        input:focus{
            border-bottom-color: orange;
        }
        img{
            margin: 1em;
            width: 128px;
            height: 128px;
            transition: transform .2s;
        }
        img:hover{
            transform: scale(2)
        }
    
    </style>
    <script type="text/javascript">
        var iconList = []
        var synonyms = {}

        function loadJSON(file, callback) {
            var xobj = new XMLHttpRequest();
            xobj.overrideMimeType("application/json");
            xobj.open('GET', file, true);
            xobj.onreadystatechange = function () {
                if (xobj.readyState == 4 && xobj.status == "200") {
                    callback(xobj.responseText);
                }
            };
            xobj.send(null);
        }

        function init() {
            loadJSON('icons.fra.json', function (response) {
                iconList = JSON.parse(response);
                updateView()
            });

            loadJSON('synonyms.fra.json', function (response) {
                synonyms = JSON.parse(response);
            });

        }

        function updateView() {
            var container = document.getElementById('iconList')
            var input = document.getElementById('input')
            container.innerHTML = ''
            if (input.value === '') {
                return
            }
            var maxItemsToDisplay = 100;
            const filteredList = iconList.filter(i => matchIcons(i, input.value))
            if (filteredList.length === 0) {
                return
            }
            for (k = 0; k < Math.min(filteredList.length, maxItemsToDisplay); k++) {
                var img = document.createElement('img');
                img.src = 'svg/' + filteredList[k].svg
                img.title = filteredList[k].svg + ' - ' + filteredList[k].name
                container.appendChild(img)
            }
        }

        const matchIcons = (iconItem, query) => {
            const words = iconItem.name.split(' ')
            //query is in name
            if (words.indexOf(query) > -1) return true
            const syn = synonyms[query]
            if (syn) {
                let found = false;
                words.forEach(word => {
                    //one of the synonym of the query is in name
                    if (syn.indexOf(word) > -1) {
                        found = true
                    }
                })
                if (found) return true
            }
            return false
        }
    </script>

</head>

<body onload="init()">
    <h1>icons-i18n test page</h1>
    <input id="input" type="text" onkeyup="updateView()">
    <div id="iconList"></div>
</body>

</html>